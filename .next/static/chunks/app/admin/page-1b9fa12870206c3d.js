(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3893:function(e,r,t){Promise.resolve().then(t.bind(t,2598))},2598:function(e,r,t){"use strict";t.r(r);var n=t(7437),s=t(2265),a=t(7648),i=t(9120);t(2563);var d=t(8675);r.default=function(){let[e,r]=(0,s.useState)({properties:0,bookings:0,requests:0}),[t,o]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{let e=(0,d.e)();try{let{data:{user:t}}=await e.auth.getUser();if(!t)return;let{data:n}=await e.from("org_members").select("org_id").eq("user_id",t.id).single();if(!n)return;let{count:s}=await e.from("properties").select("*",{count:"exact",head:!0}).eq("org_id",n.org_id),{count:a}=await e.from("bookings").select("*",{count:"exact",head:!0}).eq("org_id",n.org_id),{count:i}=await e.from("booking_requests").select("*",{count:"exact",head:!0}).eq("status","pending");r({properties:s||0,bookings:a||0,requests:i||0})}catch(e){console.error("Erreur:",e)}finally{o(!1)}})()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Pm,{}),(0,n.jsx)("div",{className:"page-container",children:(0,n.jsxs)("div",{className:"container",children:[(0,n.jsx)("h1",{children:"Tableau de bord Admin"}),(0,n.jsx)("div",{style:{background:"#dbeafe",border:"2px solid #3b82f6",padding:"1rem",borderRadius:"0.5rem",marginBottom:"2rem"},children:(0,n.jsxs)("p",{style:{margin:0,color:"#1e40af"},children:["âœ¨ Nouvelle vue: ",(0,n.jsx)(a.default,{href:"/admin/dashboard",style:{fontWeight:"bold",color:"#1d4ed8",textDecoration:"underline"},children:"Acc\xe9der au Dashboard Complet"})]})}),t?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"admin-nav",children:[(0,n.jsxs)(a.default,{href:"/admin/logements",className:"admin-card",children:[(0,n.jsx)("h3",{children:e.properties}),(0,n.jsx)("p",{children:"Logements"})]}),(0,n.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,n.jsx)("h3",{children:e.bookings}),(0,n.jsx)("p",{children:"R\xe9servations"})]}),(0,n.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,n.jsx)("h3",{children:e.requests}),(0,n.jsx)("p",{children:"Demandes en attente"})]})]}),(0,n.jsxs)("div",{style:{marginTop:"3rem"},children:[(0,n.jsx)("h2",{children:"Actions rapides"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginTop:"1rem"},children:[(0,n.jsx)(a.default,{href:"/admin/logements/new",className:"btn-primary",children:"Ajouter un logement"}),(0,n.jsx)(a.default,{href:"/admin/logements",className:"btn-secondary",children:"G\xe9rer les logements"})]})]})]})]})})]})}},2563:function(e,r,t){"use strict";t.d(r,{Q:function(){return d},c:function(){return o}});var n=t(7437),s=t(2265),a=t(9376),i=t(8675);function d(e){return function(r){let t=(0,a.useRouter)(),[d,o]=(0,s.useState)(!0),[u,l]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/login");return}l(r),o(!1)})()},[t]),d)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...r,user:u})}}function o(e){return function(r){let t=(0,a.useRouter)(),[d,o]=(0,s.useState)(!0),[u,l]=(0,s.useState)(null),[c,m]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/admin/login");return}let{data:n}=await e.from("org_members").select("role").eq("user_id",r.id).single();if(!n||"admin"!==n.role){t.push("/");return}l(r),m(n.role),o(!1)})()},[t]),d)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...r,user:u,role:c})}}},9376:function(e,r,t){"use strict";var n=t(5475);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[53,648,120,971,117,744],function(){return e(e.s=3893)}),_N_E=e.O()}]);