(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3893:function(e,r,t){Promise.resolve().then(t.bind(t,2598))},2598:function(e,r,t){"use strict";t.r(r);var n=t(7437),s=t(2265),a=t(7648),i=t(9120),d=t(2563),o=t(8675);r.default=(0,d.c)(function(e){let{isDevMode:r}=e,[t,d]=(0,s.useState)({properties:0,bookings:0,requests:0}),[l,c]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{let e=(0,o.e)();try{let{data:{user:r}}=await e.auth.getUser();if(!r)return;let{data:t}=await e.from("org_members").select("org_id").eq("user_id",r.id).single();if(!t)return;let{count:n}=await e.from("properties").select("*",{count:"exact",head:!0}).eq("org_id",t.org_id),{count:s}=await e.from("bookings").select("*",{count:"exact",head:!0}).eq("org_id",t.org_id),{count:a}=await e.from("booking_requests").select("*",{count:"exact",head:!0}).eq("status","pending");d({properties:n||0,bookings:s||0,requests:a||0})}catch(e){console.error("Erreur:",e)}finally{c(!1)}})()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Pm,{}),(0,n.jsx)("div",{className:"page-container",children:(0,n.jsxs)("div",{className:"container",children:[r&&(0,n.jsxs)("div",{style:{background:"#fef08a",border:"2px solid #eab308",padding:"1rem",borderRadius:"0.5rem",marginBottom:"2rem",display:"flex",alignItems:"center",gap:"1rem"},children:[(0,n.jsx)("span",{style:{fontSize:"1.5em"},children:"⚙️"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{style:{color:"#713f12"},children:"Mode d\xe9veloppement actif"}),(0,n.jsx)("p",{style:{margin:"0.25rem 0 0 0",color:"#92400e",fontSize:"0.9em"},children:"Acc\xe8s libre sans authentification – Interface de construction"})]})]}),(0,n.jsx)("h1",{children:"Tableau de bord Admin"}),(0,n.jsx)("div",{style:{background:"#dbeafe",border:"2px solid #3b82f6",padding:"1rem",borderRadius:"0.5rem",marginBottom:"2rem"},children:(0,n.jsxs)("p",{style:{margin:0,color:"#1e40af"},children:["✨ Nouvelle vue: ",(0,n.jsx)(a.default,{href:"/admin/dashboard",style:{fontWeight:"bold",color:"#1d4ed8",textDecoration:"underline"},children:"Acc\xe9der au Dashboard Complet"})]})}),l?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"admin-nav",children:[(0,n.jsxs)(a.default,{href:"/admin/logements",className:"admin-card",children:[(0,n.jsx)("h3",{children:t.properties}),(0,n.jsx)("p",{children:"Logements"})]}),(0,n.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,n.jsx)("h3",{children:t.bookings}),(0,n.jsx)("p",{children:"R\xe9servations"})]}),(0,n.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,n.jsx)("h3",{children:t.requests}),(0,n.jsx)("p",{children:"Demandes en attente"})]})]}),(0,n.jsxs)("div",{style:{marginTop:"3rem"},children:[(0,n.jsx)("h2",{children:"Actions rapides"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginTop:"1rem"},children:[(0,n.jsx)(a.default,{href:"/admin/logements/new",className:"btn-primary",children:"Ajouter un logement"}),(0,n.jsx)(a.default,{href:"/admin/logements",className:"btn-secondary",children:"G\xe9rer les logements"}),(0,n.jsx)(a.default,{href:"/admin/operations",className:"btn-secondary",children:"Gestion op\xe9rationnelle"})]})]})]})]})})]})})},2563:function(e,r,t){"use strict";t.d(r,{Q:function(){return o},c:function(){return l}});var n=t(7437),s=t(2265),a=t(9376),i=t(8675),d=t(2867);function o(e){return function(r){let t=(0,a.useRouter)(),[d,o]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/login");return}c(r),o(!1)})()},[t]),d)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...r,user:l})}}function l(e){return function(r){let t=(0,a.useRouter)(),[o,l]=(0,s.useState)(!0),[c,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),[f,g]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{(async()=>{if(d.D){g(!0),u({id:"dev-user",email:"dev@mode"}),h("admin"),l(!1);return}let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/admin/login");return}let{data:n}=await e.from("org_members").select("role").eq("user_id",r.id).single();if(!n||"admin"!==n.role){t.push("/");return}u(r),h(n.role),l(!1)})()},[t]),o)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...r,user:c,role:m,isDevMode:f})}}},9376:function(e,r,t){"use strict";var n=t(5475);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[53,648,120,971,117,744],function(){return e(e.s=3893)}),_N_E=e.O()}]);