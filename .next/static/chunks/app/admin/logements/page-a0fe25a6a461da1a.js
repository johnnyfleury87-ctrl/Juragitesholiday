(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[481],{9344:function(e,r,t){Promise.resolve().then(t.bind(t,3454))},3454:function(e,r,t){"use strict";t.r(r);var i=t(7437),n=t(2265),s=t(7648),o=t(9376),a=t(9120),l=t(2563),d=t(2867),c=t(8675);let u=[{id:"demo-1",title:"Chalet Montagne 12 places",location:"Jura, Morbier",price_per_night:350,max_guests:12,is_published:!0,is_demo:!0,description:"Superbe chalet avec piscine chauff\xe9e et vue panoramique"},{id:"demo-2",title:"Maison 8 places avec Jacuzzi",location:"Jura, Lons-le-Saunier",price_per_night:280,max_guests:8,is_published:!0,is_demo:!0,description:"Maison confortable avec jacuzzi priv\xe9 et jardin"}];r.default=(0,l.c)(function(e){let{isDevMode:r}=e;(0,o.useRouter)();let[t,l]=(0,n.useState)([]),[m,g]=(0,n.useState)(!0),[p,h]=(0,n.useState)(null),[f,x]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{let e=(0,c.e)();try{if(d.D){console.log("\uD83D\uDCF1 Dev Mode: Fetching all properties (no org filter)");let{data:r,error:t}=await e.from("properties").select("id, slug, title, location, price_per_night, max_guests, is_published, created_at").order("created_at",{ascending:!1});if(t)throw t;r&&r.length>0?(console.log("✅ Found ".concat(r.length," properties")),l(r)):(console.log("ℹ️ No properties in DB, showing demo data"),l(u)),g(!1);return}let{data:{user:r}}=await e.auth.getUser();if(!r)throw Error("User not authenticated");let{data:t,error:i}=await e.from("org_members").select("org_id").eq("user_id",r.id).single();if(i)throw i;if(!t)throw Error("User is not member of any organization");x(t.org_id);let{data:n,error:s}=await e.from("properties").select("id, slug, title, location, price_per_night, max_guests, is_published, created_at").eq("org_id",t.org_id).order("created_at",{ascending:!1});if(s)throw s;n&&n.length>0?l(n):(console.log("ℹ️ No properties for this org, showing demo data"),l(u))}catch(e){console.error("❌ Error fetching properties:",e),h({message:e.message,details:e.details||"Une erreur est survenue lors du chargement des logements"}),l(u)}finally{g(!1)}})()},[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.Pm,{}),(0,i.jsx)("div",{className:"page-container",children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)(s.default,{href:"/admin",style:{color:"#4F46E5"},children:"← Retour"}),(0,i.jsx)("h1",{style:{marginTop:"1rem"},children:"Gestion des logements"}),p&&(0,i.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"#FEE2E2",border:"2px solid #F87171",borderRadius:"0.5rem",color:"#DC2626"},children:[(0,i.jsx)("strong",{children:"⚠️ Erreur Supabase"}),(0,i.jsx)("p",{style:{margin:"0.5rem 0 0 0"},children:p.message}),p.details&&(0,i.jsx)("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9em"},children:p.details})]}),r&&t.some(e=>e.is_demo)&&(0,i.jsxs)("div",{style:{marginTop:"1rem",padding:"1rem",background:"#FEF3C7",border:"2px solid #FBBF24",borderRadius:"0.5rem",color:"#92400E"},children:[(0,i.jsx)("strong",{children:"ℹ️ Donn\xe9es de d\xe9monstration"}),(0,i.jsx)("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9em"},children:"Aucun logement en base de donn\xe9es. Les logements affich\xe9s ci-dessous sont fictifs."})]}),(0,i.jsx)(s.default,{href:"/admin/logements/new",className:"btn-primary",style:{marginTop:"1rem",display:"inline-block"},children:"+ Ajouter un logement"}),m?(0,i.jsx)("div",{style:{marginTop:"2rem",padding:"2rem",textAlign:"center",color:"#666"},children:(0,i.jsx)("p",{children:"⏳ Chargement des logements..."})}):0===t.length?(0,i.jsx)("div",{style:{marginTop:"2rem",padding:"2rem",background:"#F9FAFB",borderRadius:"0.5rem",textAlign:"center",color:"#666"},children:(0,i.jsx)("p",{children:"\uD83C\uDFE0 Aucun logement cr\xe9\xe9"})}):(0,i.jsx)("div",{style:{marginTop:"2rem",display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"1.5rem"},children:t.map(e=>(0,i.jsxs)("div",{style:{border:"1px solid #E5E7EB",borderRadius:"0.75rem",overflow:"hidden",background:"#FFFFFF",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",transition:"transform 0.2s, box-shadow 0.2s",cursor:"pointer"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-4px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.1)"},children:[(0,i.jsx)("div",{style:{height:"200px",background:"#E5E7EB",display:"flex",alignItems:"center",justifyContent:"center",color:"#9CA3AF",fontSize:"3em"},children:"\uD83C\uDFE0"}),(0,i.jsxs)("div",{style:{padding:"1rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"0.5rem"},children:[(0,i.jsx)("h3",{style:{margin:0,fontSize:"1.1em",color:"#1F2937",flex:1},children:e.title}),(0,i.jsx)("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"0.25rem",background:e.is_published?"#DCFCE7":"#FEE2E2",color:e.is_published?"#15803D":"#DC2626",fontSize:"0.85em",fontWeight:"600",whiteSpace:"nowrap",marginLeft:"0.5rem"},children:e.is_published?"✓ Publi\xe9":"○ Brouillon"})]}),(0,i.jsxs)("p",{style:{margin:"0.5rem 0",color:"#6B7280",fontSize:"0.9em"},children:["\uD83D\uDCCD ",e.location]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #E5E7EB"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{style:{margin:0,color:"#9CA3AF",fontSize:"0.85em"},children:"Prix / nuit"}),(0,i.jsxs)("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.2em",fontWeight:"bold",color:"#4F46E5"},children:[e.price_per_night,"€"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{style:{margin:0,color:"#9CA3AF",fontSize:"0.85em"},children:"Capacit\xe9"}),(0,i.jsx)("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.2em",fontWeight:"bold",color:"#1F2937"},children:e.max_guests?"".concat(e.max_guests," personnes"):"—"})]})]}),e.is_demo&&(0,i.jsx)("div",{style:{marginTop:"1rem",padding:"0.5rem",background:"#FEF3C7",border:"1px solid #FCD34D",borderRadius:"0.25rem",fontSize:"0.85em",color:"#92400E",textAlign:"center"},children:"\uD83D\uDCCB Donn\xe9es fictives (demo)"}),(0,i.jsxs)("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[!e.is_demo&&(0,i.jsx)(s.default,{href:"/admin/logements/".concat(e.id),style:{padding:"0.5rem",background:"#4F46E5",color:"white",borderRadius:"0.375rem",textAlign:"center",fontSize:"0.9em",fontWeight:"600",textDecoration:"none"},children:"Modifier"}),e.is_demo&&(0,i.jsx)("div",{style:{padding:"0.5rem",background:"#E5E7EB",color:"#6B7280",borderRadius:"0.375rem",textAlign:"center",fontSize:"0.9em"},children:"(Demo - non modifiable)"}),(0,i.jsx)(s.default,{href:"/logements/".concat(e.slug||e.id),style:{padding:"0.5rem",background:"#F3F4F6",color:"#4F46E5",border:"1px solid #D1D5DB",borderRadius:"0.375rem",textAlign:"center",fontSize:"0.9em",fontWeight:"600",textDecoration:"none"},children:"Voir"})]})]})]},e.id))})]})})]})})},2563:function(e,r,t){"use strict";t.d(r,{Q:function(){return l},c:function(){return d}});var i=t(7437),n=t(2265),s=t(9376),o=t(8675),a=t(2867);function l(e){return function(r){let t=(0,s.useRouter)(),[a,l]=(0,n.useState)(!0),[d,c]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,o.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/login");return}c(r),l(!1)})()},[t]),a)?(0,i.jsx)("div",{children:"Chargement..."}):(0,i.jsx)(e,{...r,user:d})}}function d(e){return function(r){let t=(0,s.useRouter)(),[l,d]=(0,n.useState)(!0),[c,u]=(0,n.useState)(null),[m,g]=(0,n.useState)(null),[p,h]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{(async()=>{if(a.D){h(!0),u({id:"dev-user",email:"dev@mode"}),g("admin"),d(!1);return}let e=(0,o.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/admin/login");return}let{data:i}=await e.from("org_members").select("role").eq("user_id",r.id).single();if(!i||"admin"!==i.role){t.push("/");return}u(r),g(i.role),d(!1)})()},[t]),l)?(0,i.jsx)("div",{children:"Chargement..."}):(0,i.jsx)(e,{...r,user:c,role:m,isDevMode:p})}}},9376:function(e,r,t){"use strict";var i=t(5475);t.o(i,"usePathname")&&t.d(r,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(r,{useRouter:function(){return i.useRouter}})}},function(e){e.O(0,[53,648,120,971,117,744],function(){return e(e.s=9344)}),_N_E=e.O()}]);