(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[948],{1788:function(e,r,t){Promise.resolve().then(t.bind(t,2333))},2333:function(e,r,t){"use strict";t.r(r);var s=t(7437),n=t(2265),i=t(7648),a=t(9376),l=t(9120),u=t(2563),o=t(8675);r.default=(0,u.c)(function(){let e=(0,a.useRouter)(),[r,t]=(0,n.useState)(null),[u,c]=(0,n.useState)({slug:"",title:"",description:"",location:"",price_per_night:"",max_guests:1,bedrooms:1,bathrooms:1,is_published:!1}),[m,d]=(0,n.useState)(!1),[h,p]=(0,n.useState)(""),[g,x]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{let e=(0,o.e)(),{data:{user:r}}=await e.auth.getUser();if(!r)return;let{data:s}=await e.from("org_members").select("org_id").eq("user_id",r.id).single();s&&t(s.org_id)})()},[]);let f=e=>{let{name:r,value:t,type:s,checked:n}=e.target;c(e=>({...e,[r]:"checkbox"===s?n:"number"===s?parseInt(t):t}))},j=async t=>{t.preventDefault(),p(""),x(""),d(!0);try{if(!r)throw Error("Org ID not found");let t=(0,o.e)(),{data:s,error:n}=await t.from("properties").insert([{...u,org_id:r,price_per_night:parseFloat(u.price_per_night)}]).select();if(n)throw n;x("Logement cr\xe9\xe9 avec succ\xe8s"),setTimeout(()=>{e.push("/admin/logements")},1500)}catch(e){p(e.message||"Erreur lors de la cr\xe9ation")}finally{d(!1)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Pm,{}),(0,s.jsx)("div",{className:"page-container",children:(0,s.jsxs)("div",{className:"container",style:{maxWidth:"800px"},children:[(0,s.jsx)(i.default,{href:"/admin/logements",style:{color:"#4F46E5"},children:"← Retour"}),(0,s.jsx)("h1",{style:{marginTop:"1rem"},children:"Cr\xe9er un logement"}),h&&(0,s.jsx)("div",{className:"error-message",style:{marginTop:"1rem"},children:h}),g&&(0,s.jsx)("div",{className:"success-message",style:{marginTop:"1rem"},children:g}),(0,s.jsxs)("form",{onSubmit:j,style:{marginTop:"2rem"},children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Slug (URL)"}),(0,s.jsx)("input",{type:"text",name:"slug",value:u.slug,onChange:f,required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Titre"}),(0,s.jsx)("input",{type:"text",name:"title",value:u.title,onChange:f,required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Description"}),(0,s.jsx)("textarea",{name:"description",value:u.description,onChange:f})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Localisation"}),(0,s.jsx)("input",{type:"text",name:"location",value:u.location,onChange:f,required:!0})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Prix par nuit (€)"}),(0,s.jsx)("input",{type:"number",name:"price_per_night",value:u.price_per_night,onChange:f,step:"0.01",required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Personnes maximum"}),(0,s.jsx)("input",{type:"number",name:"max_guests",value:u.max_guests,onChange:f,min:"1",required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Chambres"}),(0,s.jsx)("input",{type:"number",name:"bedrooms",value:u.bedrooms,onChange:f,min:"1",required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{children:"Salles de bain"}),(0,s.jsx)("input",{type:"number",name:"bathrooms",value:u.bathrooms,onChange:f,min:"1",required:!0})]})]}),(0,s.jsx)("div",{className:"form-group",children:(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,s.jsx)("input",{type:"checkbox",name:"is_published",checked:u.is_published,onChange:f,style:{marginRight:"0.5rem",width:"auto"}}),"Publier ce logement"]})}),(0,s.jsx)("button",{type:"submit",disabled:m,className:"btn-primary",children:m?"Cr\xe9ation...":"Cr\xe9er le logement"})]})]})})]})})},2563:function(e,r,t){"use strict";t.d(r,{Q:function(){return l},c:function(){return u}});var s=t(7437),n=t(2265),i=t(9376),a=t(8675);function l(e){return function(r){let t=(0,i.useRouter)(),[l,u]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,a.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/login");return}c(r),u(!1)})()},[t]),l)?(0,s.jsx)("div",{children:"Chargement..."}):(0,s.jsx)(e,{...r,user:o})}}function u(e){return function(r){let t=(0,i.useRouter)(),[l,u]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null),[m,d]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,a.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/admin/login");return}let{data:s}=await e.from("org_members").select("role").eq("user_id",r.id).single();if(!s||"admin"!==s.role){t.push("/");return}c(r),d(s.role),u(!1)})()},[t]),l)?(0,s.jsx)("div",{children:"Chargement..."}):(0,s.jsx)(e,{...r,user:o,role:m})}}},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[53,648,120,971,117,744],function(){return e(e.s=1788)}),_N_E=e.O()}]);