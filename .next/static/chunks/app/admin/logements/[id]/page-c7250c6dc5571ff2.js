(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[119],{389:function(e,r,s){Promise.resolve().then(s.bind(s,7907))},7907:function(e,r,s){"use strict";s.r(r);var t=s(7437),n=s(2265),i=s(7648),a=s(9376),l=s(9120),u=s(2563),o=s(8675);r.default=(0,u.c)(function(e){let{params:r}=e,s=(0,a.useRouter)(),{id:u}=r,[c,d]=(0,n.useState)(null),[m,h]=(0,n.useState)({slug:"",title:"",description:"",location:"",price_per_night:"",max_guests:1,bedrooms:1,bathrooms:1,is_published:!1}),[p,g]=(0,n.useState)(!0),[x,j]=(0,n.useState)(!1),[f,b]=(0,n.useState)(""),[v,y]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{let e=(0,o.e)();try{let{data:{user:r}}=await e.auth.getUser();if(!r)return;let{data:s,error:t}=await e.from("properties").select("*").eq("id",u).single();if(t)throw t;d(s),h(s)}catch(e){b("Propri\xe9t\xe9 non trouv\xe9e")}finally{g(!1)}})()},[u]);let _=e=>{let{name:r,value:s,type:t,checked:n}=e.target;h(e=>({...e,[r]:"checkbox"===t?n:"number"===t?parseInt(s):s}))},N=async e=>{e.preventDefault(),b(""),y(""),j(!0);try{let e=(0,o.e)(),{error:r}=await e.from("properties").update(m).eq("id",u);if(r)throw r;y("Logement mis \xe0 jour avec succ\xe8s"),setTimeout(()=>{s.push("/admin/logements")},1500)}catch(e){b(e.message||"Erreur lors de la mise \xe0 jour")}finally{j(!1)}};return p?(0,t.jsxs)("div",{children:[(0,t.jsx)(l.Pm,{}),(0,t.jsx)("div",{className:"page-container container",children:"Chargement..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Pm,{}),(0,t.jsx)("div",{className:"page-container",children:(0,t.jsxs)("div",{className:"container",style:{maxWidth:"800px"},children:[(0,t.jsx)(i.default,{href:"/admin/logements",style:{color:"#4F46E5"},children:"← Retour"}),(0,t.jsx)("h1",{style:{marginTop:"1rem"},children:"Modifier le logement"}),f&&(0,t.jsx)("div",{className:"error-message",style:{marginTop:"1rem"},children:f}),v&&(0,t.jsx)("div",{className:"success-message",style:{marginTop:"1rem"},children:v}),(0,t.jsxs)("form",{onSubmit:N,style:{marginTop:"2rem"},children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Slug (URL)"}),(0,t.jsx)("input",{type:"text",name:"slug",value:m.slug,onChange:_,required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Titre"}),(0,t.jsx)("input",{type:"text",name:"title",value:m.title,onChange:_,required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Description"}),(0,t.jsx)("textarea",{name:"description",value:m.description,onChange:_})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Localisation"}),(0,t.jsx)("input",{type:"text",name:"location",value:m.location,onChange:_,required:!0})]}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Prix par nuit (€)"}),(0,t.jsx)("input",{type:"number",name:"price_per_night",value:m.price_per_night,onChange:_,step:"0.01",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Personnes maximum"}),(0,t.jsx)("input",{type:"number",name:"max_guests",value:m.max_guests,onChange:_,min:"1",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Chambres"}),(0,t.jsx)("input",{type:"number",name:"bedrooms",value:m.bedrooms,onChange:_,min:"1",required:!0})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Salles de bain"}),(0,t.jsx)("input",{type:"number",name:"bathrooms",value:m.bathrooms,onChange:_,min:"1",required:!0})]})]}),(0,t.jsx)("div",{className:"form-group",children:(0,t.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,t.jsx)("input",{type:"checkbox",name:"is_published",checked:m.is_published,onChange:_,style:{marginRight:"0.5rem",width:"auto"}}),"Publier ce logement"]})}),(0,t.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,t.jsx)("button",{type:"submit",disabled:x,className:"btn-primary",children:x?"Mise \xe0 jour...":"Enregistrer"}),(0,t.jsx)("button",{type:"button",onClick:()=>s.push("/admin/logements"),className:"btn-secondary",children:"Annuler"})]})]}),(0,t.jsxs)("div",{style:{marginTop:"3rem",padding:"2rem",background:"#F9FAFB",borderRadius:"0.75rem"},children:[(0,t.jsx)("h2",{children:"Photos"}),(0,t.jsx)("p",{style:{color:"#6B7280",marginTop:"0.5rem"},children:"TODO: Impl\xe9menter la gestion des photos de propri\xe9t\xe9"})]})]})})]})})},2563:function(e,r,s){"use strict";s.d(r,{Q:function(){return l},c:function(){return u}});var t=s(7437),n=s(2265),i=s(9376),a=s(8675);function l(e){return function(r){let s=(0,i.useRouter)(),[l,u]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,a.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){s.push("/login");return}c(r),u(!1)})()},[s]),l)?(0,t.jsx)("div",{children:"Chargement..."}):(0,t.jsx)(e,{...r,user:o})}}function u(e){return function(r){let s=(0,i.useRouter)(),[l,u]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null),[d,m]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,a.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){s.push("/admin/login");return}let{data:t}=await e.from("org_members").select("role").eq("user_id",r.id).single();if(!t||"admin"!==t.role){s.push("/");return}c(r),m(t.role),u(!1)})()},[s]),l)?(0,t.jsx)("div",{children:"Chargement..."}):(0,t.jsx)(e,{...r,user:o,role:d})}}},9376:function(e,r,s){"use strict";var t=s(5475);s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})}},function(e){e.O(0,[223,120,971,117,744],function(){return e(e.s=389)}),_N_E=e.O()}]);