(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[481],{9344:function(e,t,r){Promise.resolve().then(r.bind(r,3454))},3454:function(e,t,r){"use strict";r.r(t);var i=r(7437),n=r(2265),s=r(7648),l=r(9376),d=r(9120),a=r(2563),u=r(8675);t.default=(0,a.c)(function(){(0,l.useRouter)();let[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{let e=(0,u.e)();try{let{data:{user:r}}=await e.auth.getUser();if(!r)return;let{data:i}=await e.from("org_members").select("org_id").eq("user_id",r.id).single();if(!i)return;c(i.org_id);let{data:n,error:s}=await e.from("properties").select("id, slug, title, location, price_per_night, is_published").eq("org_id",i.org_id).order("created_at",{ascending:!1});if(s)throw s;t(n||[])}catch(e){console.error("Erreur:",e)}finally{a(!1)}})()},[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.Pm,{}),(0,i.jsx)("div",{className:"page-container",children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)(s.default,{href:"/admin",style:{color:"#4F46E5"},children:"← Retour"}),(0,i.jsx)("h1",{style:{marginTop:"1rem"},children:"Gestion des logements"}),(0,i.jsx)(s.default,{href:"/admin/logements/new",className:"btn-primary",style:{marginTop:"1rem",display:"inline-block"},children:"+ Ajouter un logement"}),r?(0,i.jsx)("div",{style:{marginTop:"2rem"},children:"Chargement..."}):0===e.length?(0,i.jsx)("div",{style:{marginTop:"2rem",padding:"2rem",background:"#F9FAFB",borderRadius:"0.5rem"},children:(0,i.jsx)("p",{children:"Aucun logement cr\xe9\xe9"})}):(0,i.jsx)("div",{style:{marginTop:"2rem"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"2px solid #E5E7EB",background:"#F9FAFB"},children:[(0,i.jsx)("th",{style:{textAlign:"left",padding:"1rem"},children:"Titre"}),(0,i.jsx)("th",{style:{textAlign:"left",padding:"1rem"},children:"Localisation"}),(0,i.jsx)("th",{style:{textAlign:"left",padding:"1rem"},children:"Prix / nuit"}),(0,i.jsx)("th",{style:{textAlign:"left",padding:"1rem"},children:"Publi\xe9"}),(0,i.jsx)("th",{style:{textAlign:"left",padding:"1rem"},children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #E5E7EB"},children:[(0,i.jsx)("td",{style:{padding:"1rem"},children:e.title}),(0,i.jsx)("td",{style:{padding:"1rem"},children:e.location}),(0,i.jsxs)("td",{style:{padding:"1rem"},children:[e.price_per_night,"€"]}),(0,i.jsx)("td",{style:{padding:"1rem"},children:(0,i.jsx)("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"0.25rem",background:e.is_published?"#DCFCE7":"#FEE2E2",color:e.is_published?"#15803D":"#DC2626"},children:e.is_published?"Oui":"Non"})}),(0,i.jsx)("td",{style:{padding:"1rem"},children:(0,i.jsx)(s.default,{href:"/admin/logements/".concat(e.id),style:{color:"#4F46E5",marginRight:"1rem"},children:"Modifier"})})]},e.id))})]})})]})})]})})},2563:function(e,t,r){"use strict";r.d(t,{Q:function(){return d},c:function(){return a}});var i=r(7437),n=r(2265),s=r(9376),l=r(8675);function d(e){return function(t){let r=(0,s.useRouter)(),[d,a]=(0,n.useState)(!0),[u,o]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,l.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){r.push("/login");return}o(t),a(!1)})()},[r]),d)?(0,i.jsx)("div",{children:"Chargement..."}):(0,i.jsx)(e,{...t,user:u})}}function a(e){return function(t){let r=(0,s.useRouter)(),[d,a]=(0,n.useState)(!0),[u,o]=(0,n.useState)(null),[c,h]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,l.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){r.push("/admin/login");return}let{data:i}=await e.from("org_members").select("role").eq("user_id",t.id).single();if(!i||"admin"!==i.role){r.push("/");return}o(t),h(i.role),a(!1)})()},[r]),d)?(0,i.jsx)("div",{children:"Chargement..."}):(0,i.jsx)(e,{...t,user:u,role:c})}}},9376:function(e,t,r){"use strict";var i=r(5475);r.o(i,"useRouter")&&r.d(t,{useRouter:function(){return i.useRouter}})}},function(e){e.O(0,[223,120,971,117,744],function(){return e(e.s=9344)}),_N_E=e.O()}]);