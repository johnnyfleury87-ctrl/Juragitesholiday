(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3893:function(e,t,r){Promise.resolve().then(r.bind(r,2598))},2598:function(e,t,r){"use strict";r.r(t);var n=r(7437),s=r(2265),a=r(7648),i=r(9120),u=r(2563),l=r(8675);t.default=(0,u.c)(function(){let[e,t]=(0,s.useState)({properties:0,bookings:0,requests:0}),[r,u]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{let e=(0,l.e)();try{let{data:{user:r}}=await e.auth.getUser();if(!r)return;let{data:n}=await e.from("org_members").select("org_id").eq("user_id",r.id).single();if(!n)return;let{count:s}=await e.from("properties").select("*",{count:"exact",head:!0}).eq("org_id",n.org_id),{count:a}=await e.from("bookings").select("*",{count:"exact",head:!0}).eq("org_id",n.org_id),{count:i}=await e.from("booking_requests").select("*",{count:"exact",head:!0}).eq("status","pending");t({properties:s||0,bookings:a||0,requests:i||0})}catch(e){console.error("Erreur:",e)}finally{u(!1)}})()},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Pm,{}),(0,n.jsx)("div",{className:"page-container",children:(0,n.jsxs)("div",{className:"container",children:[(0,n.jsx)("h1",{children:"Tableau de bord Admin"}),r?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"admin-nav",children:[(0,n.jsxs)(a.default,{href:"/admin/logements",className:"admin-card",children:[(0,n.jsx)("h3",{children:e.properties}),(0,n.jsx)("p",{children:"Logements"})]}),(0,n.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,n.jsx)("h3",{children:e.bookings}),(0,n.jsx)("p",{children:"R\xe9servations"})]}),(0,n.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,n.jsx)("h3",{children:e.requests}),(0,n.jsx)("p",{children:"Demandes en attente"})]})]}),(0,n.jsxs)("div",{style:{marginTop:"3rem"},children:[(0,n.jsx)("h2",{children:"Actions rapides"}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginTop:"1rem"},children:[(0,n.jsx)(a.default,{href:"/admin/logements/new",className:"btn-primary",children:"Ajouter un logement"}),(0,n.jsx)(a.default,{href:"/admin/logements",className:"btn-secondary",children:"G\xe9rer les logements"})]})]})]})]})})]})})},2563:function(e,t,r){"use strict";r.d(t,{Q:function(){return u},c:function(){return l}});var n=r(7437),s=r(2265),a=r(9376),i=r(8675);function u(e){return function(t){let r=(0,a.useRouter)(),[u,l]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){r.push("/login");return}o(t),l(!1)})()},[r]),u)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...t,user:c})}}function l(e){return function(t){let r=(0,a.useRouter)(),[u,l]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),[d,m]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){r.push("/admin/login");return}let{data:n}=await e.from("org_members").select("role").eq("user_id",t.id).single();if(!n||"admin"!==n.role){r.push("/");return}o(t),m(n.role),l(!1)})()},[r]),u)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...t,user:c,role:d})}}},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[223,120,971,117,744],function(){return e(e.s=3893)}),_N_E=e.O()}]);