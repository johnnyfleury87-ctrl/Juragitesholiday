(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{3893:function(e,r,t){Promise.resolve().then(t.bind(t,2598))},2598:function(e,r,t){"use strict";t.r(r);var s=t(7437),n=t(2265),a=t(7648),i=t(9120),u=t(2563),l=t(8675);r.default=(0,u.c)(function(){let[e,r]=(0,n.useState)({properties:0,bookings:0,requests:0}),[t,u]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{(async()=>{let e=(0,l.e)();try{let{data:{user:t}}=await e.auth.getUser();if(!t)return;let{data:s}=await e.from("org_members").select("org_id").eq("user_id",t.id).single();if(!s)return;let{count:n}=await e.from("properties").select("*",{count:"exact",head:!0}).eq("org_id",s.org_id),{count:a}=await e.from("bookings").select("*",{count:"exact",head:!0}).eq("org_id",s.org_id),{count:i}=await e.from("booking_requests").select("*",{count:"exact",head:!0}).eq("status","pending");r({properties:n||0,bookings:a||0,requests:i||0})}catch(e){console.error("Erreur:",e)}finally{u(!1)}})()},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Pm,{}),(0,s.jsx)("div",{className:"page-container",children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("h1",{children:"Tableau de bord Admin"}),t?(0,s.jsx)("div",{children:"Chargement..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"admin-nav",children:[(0,s.jsxs)(a.default,{href:"/admin/logements",className:"admin-card",children:[(0,s.jsx)("h3",{children:e.properties}),(0,s.jsx)("p",{children:"Logements"})]}),(0,s.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,s.jsx)("h3",{children:e.bookings}),(0,s.jsx)("p",{children:"R\xe9servations"})]}),(0,s.jsxs)(a.default,{href:"/admin/reservations",className:"admin-card",children:[(0,s.jsx)("h3",{children:e.requests}),(0,s.jsx)("p",{children:"Demandes en attente"})]})]}),(0,s.jsxs)("div",{style:{marginTop:"3rem"},children:[(0,s.jsx)("h2",{children:"Actions rapides"}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem",marginTop:"1rem"},children:[(0,s.jsx)(a.default,{href:"/admin/logements/new",className:"btn-primary",children:"Ajouter un logement"}),(0,s.jsx)(a.default,{href:"/admin/logements",className:"btn-secondary",children:"G\xe9rer les logements"})]})]})]})]})})]})})},2563:function(e,r,t){"use strict";t.d(r,{Q:function(){return u},c:function(){return l}});var s=t(7437),n=t(2265),a=t(9376),i=t(8675);function u(e){return function(r){let t=(0,a.useRouter)(),[u,l]=(0,n.useState)(!0),[c,d]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/login");return}d(r),l(!1)})()},[t]),u)?(0,s.jsx)("div",{children:"Chargement..."}):(0,s.jsx)(e,{...r,user:c})}}function l(e){return function(r){let t=(0,a.useRouter)(),[u,l]=(0,n.useState)(!0),[c,d]=(0,n.useState)(null),[o,m]=(0,n.useState)(null);return((0,n.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser();if(!r){t.push("/admin/login");return}let{data:s}=await e.from("org_members").select("role").eq("user_id",r.id).single();if(!s||"admin"!==s.role){t.push("/");return}d(r),m(s.role),l(!1)})()},[t]),u)?(0,s.jsx)("div",{children:"Chargement..."}):(0,s.jsx)(e,{...r,user:c,role:o})}}},9376:function(e,r,t){"use strict";var s=t(5475);t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[223,120,971,117,744],function(){return e(e.s=3893)}),_N_E=e.O()}]);