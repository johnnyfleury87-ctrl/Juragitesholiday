(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{4516:function(e,t,r){Promise.resolve().then(r.bind(r,115))},115:function(e,t,r){"use strict";r.r(t);var n=r(7437),s=r(2265),l=r(7648),i=r(9120),a=r(2563),u=r(8675);t.default=(0,a.Q)(function(){let[e,t]=(0,s.useState)(null),[r,a]=(0,s.useState)(!0),[o,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)(""),[h,f]=(0,s.useState)(""),[g,p]=(0,s.useState)(!1),[x,j]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{let e=(0,u.e)();try{let{data:{user:r}}=await e.auth.getUser();if(!r)return;let{data:n,error:s}=await e.from("profiles").select("*").eq("id",r.id).single();if(s&&"PGRST116"!==s.code)throw s;n&&(t(n),m(n.full_name||""),f(n.phone||""))}catch(e){console.error("Erreur:",e)}finally{a(!1)}})()},[]);let v=async()=>{p(!0),j("");try{let e=(0,u.e)(),{data:{user:t}}=await e.auth.getUser(),{error:r}=await e.from("profiles").update({full_name:d,phone:h}).eq("id",t.id);if(r)throw r;j("Profil mis \xe0 jour avec succ\xe8s"),c(!1),setTimeout(()=>j(""),3e3)}catch(e){j("Erreur lors de la mise \xe0 jour")}finally{p(!1)}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.DK,{}),(0,n.jsx)("div",{className:"page-container",children:(0,n.jsxs)("div",{className:"container",style:{maxWidth:"600px"},children:[(0,n.jsx)(l.default,{href:"/app",style:{color:"#4F46E5"},children:"â† Retour"}),(0,n.jsx)("h1",{style:{marginTop:"1rem"},children:"Mon profil"}),x&&(0,n.jsx)("div",{className:x.includes("succ\xe8s")?"success-message":"error-message",style:{marginTop:"1rem"},children:x}),r?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)("div",{style:{marginTop:"2rem",padding:"2rem",background:"#F9FAFB",borderRadius:"0.75rem"},children:o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"Nom complet"}),(0,n.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value)})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{children:"T\xe9l\xe9phone"}),(0,n.jsx)("input",{type:"tel",value:h,onChange:e=>f(e.target.value)})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,n.jsx)("button",{onClick:v,disabled:g,className:"btn-primary",children:g?"Enregistrement...":"Enregistrer"}),(0,n.jsx)("button",{onClick:()=>{c(!1),m((null==e?void 0:e.full_name)||""),f((null==e?void 0:e.phone)||"")},className:"btn-secondary",children:"Annuler"})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,n.jsx)("strong",{children:"Email:"}),(0,n.jsx)("p",{children:null==e?void 0:e.email})]}),(0,n.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,n.jsx)("strong",{children:"Nom complet:"}),(0,n.jsx)("p",{children:(null==e?void 0:e.full_name)||"Non renseign\xe9"})]}),(0,n.jsxs)("div",{style:{marginBottom:"1.5rem"},children:[(0,n.jsx)("strong",{children:"T\xe9l\xe9phone:"}),(0,n.jsx)("p",{children:(null==e?void 0:e.phone)||"Non renseign\xe9"})]}),(0,n.jsx)("button",{onClick:()=>c(!0),className:"btn-primary",children:"Modifier"})]})})]})})]})})},2563:function(e,t,r){"use strict";r.d(t,{Q:function(){return a},c:function(){return u}});var n=r(7437),s=r(2265),l=r(9376),i=r(8675);function a(e){return function(t){let r=(0,l.useRouter)(),[a,u]=(0,s.useState)(!0),[o,c]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){r.push("/login");return}c(t),u(!1)})()},[r]),a)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...t,user:o})}}function u(e){return function(t){let r=(0,l.useRouter)(),[a,u]=(0,s.useState)(!0),[o,c]=(0,s.useState)(null),[d,m]=(0,s.useState)(null);return((0,s.useEffect)(()=>{(async()=>{let e=(0,i.e)(),{data:{user:t}}=await e.auth.getUser();if(!t){r.push("/admin/login");return}let{data:n}=await e.from("org_members").select("role").eq("user_id",t.id).single();if(!n||"admin"!==n.role){r.push("/");return}c(t),m(n.role),u(!1)})()},[r]),a)?(0,n.jsx)("div",{children:"Chargement..."}):(0,n.jsx)(e,{...t,user:o,role:d})}}},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})}},function(e){e.O(0,[223,120,971,117,744],function(){return e(e.s=4516)}),_N_E=e.O()}]);