(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{376:function(e,r,s){Promise.resolve().then(s.bind(s,3403))},3403:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return d}});var i=s(7437),n=s(2265),t=s(7648),l=s(9376),a=s(9120),o=s(8675);function d(e){let{params:r}=e,s=(0,l.useRouter)(),{slug:d}=r,[c,u]=(0,n.useState)(null),[h,m]=(0,n.useState)([]),[p,g]=(0,n.useState)(null),[x,j]=(0,n.useState)(!0),[f,v]=(0,n.useState)(!1),[y,_]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{let e=(0,o.e)();try{let{data:{user:r}}=await e.auth.getUser();g(r);let{data:s,error:i}=await e.from("properties").select("*").eq("slug",d).eq("is_published",!0).single();if(i)throw i;if(u(s),s){let{data:r,error:i}=await e.from("property_photos").select("*").eq("property_id",s.id).order("display_order");i||m(r||[])}}catch(e){console.error("Erreur:",e)}finally{j(!1)}})()},[d]);let b=async e=>{if(!p){s.push("/login");return}v(!0),_("");try{let r=(0,o.e)(),{error:i}=await r.from("booking_requests").insert([{property_id:c.id,client_id:p.id,check_in:e.checkIn,check_out:e.checkOut,num_guests:e.numGuests,status:"pending"}]);if(i)throw i;_("Demande de r\xe9servation envoy\xe9e avec succ\xe8s !"),setTimeout(()=>{s.push("/app/reservations")},1500)}catch(e){console.error("Erreur:",e),_("Erreur lors de l'envoi de la demande")}finally{v(!1)}};return x?(0,i.jsxs)("div",{children:[(0,i.jsx)(a.sZ,{}),(0,i.jsx)("div",{className:"page-container container",children:"Chargement..."})]}):c?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.sZ,{}),(0,i.jsx)("div",{className:"page-container",children:(0,i.jsxs)("div",{className:"container",children:[(0,i.jsx)(t.default,{href:"/logements",style:{color:"#4F46E5"},children:"← Retour aux logements"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"3rem",marginTop:"2rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{children:c.title}),(0,i.jsx)("p",{className:"location",children:c.location}),(0,i.jsx)("p",{style:{marginTop:"1rem",lineHeight:"1.6"},children:c.description}),(0,i.jsxs)("div",{style:{marginTop:"2rem",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Personnes max:"})," ",c.max_guests]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Chambres:"})," ",c.bedrooms]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Salles de bain:"})," ",c.bathrooms]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Prix / nuit:"})," ",c.price_per_night,"€"]})]}),(0,i.jsxs)("div",{style:{marginTop:"2rem"},children:[(0,i.jsx)("h3",{children:"Galerie"}),0===h.length?(0,i.jsx)("p",{children:"Aucune photo disponible"}):(0,i.jsx)("div",{className:"grid grid-cols-2",style:{marginTop:"1rem"},children:h.map((e,r)=>(0,i.jsxs)("div",{style:{borderRadius:"0.5rem",objectFit:"cover",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",height:"200px",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:["\uD83D\uDCF8 Photo ",r+1]},e.id))})]})]}),(0,i.jsxs)("div",{children:[y&&(0,i.jsx)("div",{className:y.includes("succ\xe8s")?"success-message":"error-message",children:y}),(0,i.jsx)(a.fl,{propertyId:c.id,onSubmit:b,loading:f})]})]})]})}),(0,i.jsx)(a.dX,{})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)(a.sZ,{}),(0,i.jsx)("div",{className:"page-container container",children:"Propri\xe9t\xe9 non trouv\xe9e"})]})}},9376:function(e,r,s){"use strict";var i=s(5475);s.o(i,"useRouter")&&s.d(r,{useRouter:function(){return i.useRouter}})}},function(e){e.O(0,[223,120,971,117,744],function(){return e(e.s=376)}),_N_E=e.O()}]);